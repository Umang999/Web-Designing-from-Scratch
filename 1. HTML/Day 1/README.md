Explanation is given inside code as comments.
